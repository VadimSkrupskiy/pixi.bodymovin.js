{"version":3,"file":"index.js","sources":["../src/patch/DisplayObject.js","../src/patch/Point.js","../src/utils/Utils.js","../src/utils/PropsMap.js","../src/utils/Curve.js","../src/utils/BezierCurve.js","../src/utils/BezierEasing.js","../src/utils/Easeing.js","../src/core/KeyframesBuffer.js","../src/core/AnimationGroup.js","../src/index.js"],"sourcesContent":["import {\r\n  DisplayObject,\r\n} from 'pixi.js';\r\n\r\n/**\r\n * add some patch\r\n */\r\nObject.defineProperties(DisplayObject.prototype, {\r\n  /**\r\n   * An alias to scale.x\r\n   * @member {number}\r\n   */\r\n  scaleX: {\r\n    get: function() {\r\n      return this.scale.x;\r\n    },\r\n    set: function(value) {\r\n      this.scale.x = value;\r\n    },\r\n  },\r\n  /**\r\n   * An alias to scale.x\r\n   * @member {number}\r\n   */\r\n  scaleY: {\r\n    get: function() {\r\n      return this.scale.y;\r\n    },\r\n    set: function(value) {\r\n      this.scale.y = value;\r\n    },\r\n  },\r\n  /**\r\n   * An alias to pivot.x\r\n   * @member {number}\r\n   */\r\n  pivotX: {\r\n    get: function() {\r\n      return this.pivot.x;\r\n    },\r\n    set: function(value) {\r\n      this.pivot.x = value;\r\n    },\r\n  },\r\n  /**\r\n   * An alias to pivot.x\r\n   * @member {number}\r\n   */\r\n  pivotY: {\r\n    get: function() {\r\n      return this.pivot.y;\r\n    },\r\n    set: function(value) {\r\n      this.pivot.y = value;\r\n    },\r\n  },\r\n});\r\n","import {\r\n  Point,\r\n} from 'pixi.js';\r\n\r\n/**\r\n * get a distance to point-v\r\n * @param {Point} v target point\r\n * @return {number} distance\r\n */\r\nPoint.prototype.distanceTo = function( v ) {\r\n  return Math.sqrt( this.distanceToSquared( v ) );\r\n};\r\n\r\n/**\r\n * get a distance squared to point-v\r\n * @param {Point} v target point\r\n * @return {number} distance squared\r\n */\r\nPoint.prototype.distanceToSquared = function( v ) {\r\n  const dx = this.x - v.x;\r\n  const dy = this.y - v.y;\r\n  return dx * dx + dy * dy;\r\n};\r\n","/**\r\n * get the type by Object.prototype.toString\r\n * @param {*} val\r\n * @return {String} type string value\r\n */\r\nfunction _rt(val) {\r\n  return Object.prototype.toString.call(val);\r\n}\r\n\r\n/**\r\n * some useful toolkit\r\n */\r\nconst Utils = {\r\n  /**\r\n   * simple copy a json data\r\n   *\r\n   * @static\r\n   * @memberof JC.Utils\r\n   * @param {JSON} json source data\r\n   * @return {JSON} object\r\n   */\r\n  copyJSON: function(json) {\r\n    return JSON.parse(JSON.stringify(json));\r\n  },\r\n\r\n  /**\r\n   * detect the variable is array type\r\n   *\r\n   * @static\r\n   * @method\r\n   * @memberof JC.Utils\r\n   * @param {Array} variable input variable\r\n   * @return {Boolean} result\r\n   */\r\n  isArray: (function() {\r\n    let ks = _rt([]);\r\n    return function(variable) {\r\n      return _rt(variable) === ks;\r\n    };\r\n  })(),\r\n\r\n  /**\r\n   * detect the variable is string type\r\n   *\r\n   * @static\r\n   * @method\r\n   * @memberof JC.Utils\r\n   * @param {String} variable input variable\r\n   * @return {Boolean} result\r\n   */\r\n  isString: (function() {\r\n    let ks = _rt('s');\r\n    return function(variable) {\r\n      return _rt(variable) === ks;\r\n    };\r\n  })(),\r\n\r\n  /**\r\n   * detect the variable is number type\r\n   *\r\n   * @static\r\n   * @method\r\n   * @memberof JC.Utils\r\n   * @param {Number} variable input variable\r\n   * @return {Boolean} result\r\n   */\r\n  isNumber: (function() {\r\n    let ks = _rt(1);\r\n    return function(variable) {\r\n      return _rt(variable) === ks;\r\n    };\r\n  })(),\r\n\r\n  /**\r\n   * euclidean modulo\r\n   *\r\n   * @static\r\n   * @method\r\n   * @memberof JC.Utils\r\n   * @param {Number} n input value\r\n   * @param {Number} m modulo\r\n   * @return {Number} re-map to modulo area\r\n   */\r\n  euclideanModulo: function(n, m) {\r\n    return ((n % m) + m) % m;\r\n  },\r\n\r\n  /**\r\n   * bounce value when value spill codomain\r\n   *\r\n   * @static\r\n   * @method\r\n   * @memberof JC.Utils\r\n   * @param {Number} n input value\r\n   * @param {Number} min lower boundary\r\n   * @param {Number} max upper boundary\r\n   * @return {Number} bounce back to boundary area\r\n   */\r\n  codomainBounce: function(n, min, max) {\r\n    if (n < min) return 2 * min - n;\r\n    if (n > max) return 2 * max - n;\r\n    return n;\r\n  },\r\n\r\n  /**\r\n   * clamp a value in range\r\n   *\r\n   * @static\r\n   * @method\r\n   * @memberof JC.Utils\r\n   * @param {Number} x input value\r\n   * @param {Number} a lower boundary\r\n   * @param {Number} b upper boundary\r\n   * @return {Number} clamp in range\r\n   */\r\n  clamp: function(x, a, b) {\r\n    return (x < a) ? a : ((x > b) ? b : x);\r\n  },\r\n};\r\n\r\nexport default Utils;\r\n","\r\nexport const PROPS_MAP = {\r\n  o: {\r\n    props: ['alpha'],\r\n    scale: 0.01,\r\n  },\r\n  r: {\r\n    props: ['rotation'],\r\n    scale: Math.PI / 180,\r\n  },\r\n  p: {\r\n    props: ['x', 'y'],\r\n    scale: 1,\r\n  },\r\n  a: {\r\n    props: ['pivotX', 'pivotY'],\r\n    scale: 1,\r\n  },\r\n  s: {\r\n    props: ['scaleX', 'scaleY'],\r\n    scale: 0.01,\r\n  },\r\n};\r\n","\r\n/**\r\n * @class\r\n */\r\nfunction Curve() {}\r\n\r\nCurve.prototype = {\r\n\r\n  constructor: Curve,\r\n\r\n  getPoint: function( t ) {\r\n    console.warn( 'Curve: Warning, getPoint() not implemented!', t );\r\n    return null;\r\n  },\r\n\r\n  getPointAt: function( u ) {\r\n    let t = this.getUtoTmapping( u );\r\n    return this.getPoint( t );\r\n  },\r\n\r\n  getPoints: function( divisions ) {\r\n    if ( isNaN( divisions ) ) divisions = 5;\r\n\r\n    let points = [];\r\n\r\n    for ( let d = 0; d <= divisions; d ++ ) {\r\n      points.push( this.getPoint( d / divisions ) );\r\n    }\r\n\r\n    return points;\r\n  },\r\n\r\n  getSpacedPoints: function( divisions ) {\r\n    if ( isNaN( divisions ) ) divisions = 5;\r\n\r\n    let points = [];\r\n\r\n    for ( let d = 0; d <= divisions; d ++ ) {\r\n      points.push( this.getPointAt( d / divisions ) );\r\n    }\r\n\r\n    return points;\r\n  },\r\n\r\n  getLength: function() {\r\n    let lengths = this.getLengths();\r\n    return lengths[lengths.length - 1];\r\n  },\r\n\r\n  getLengths: function( divisions ) {\r\n    if (isNaN(divisions)) {\r\n      divisions = ( this.__arcLengthDivisions ) ?\r\n        ( this.__arcLengthDivisions ) :\r\n        200;\r\n    }\r\n\r\n    if ( this.cacheArcLengths\r\n      && ( this.cacheArcLengths.length === divisions + 1 )\r\n      && ! this.needsUpdate ) {\r\n      return this.cacheArcLengths;\r\n    }\r\n\r\n    this.needsUpdate = false;\r\n\r\n    let cache = [];\r\n    let current;\r\n    let last = this.getPoint( 0 );\r\n    let p;\r\n    let sum = 0;\r\n\r\n    cache.push( 0 );\r\n\r\n    for ( p = 1; p <= divisions; p ++ ) {\r\n      current = this.getPoint( p / divisions );\r\n      sum += current.distanceTo( last );\r\n      cache.push( sum );\r\n      last = current;\r\n    }\r\n    this.cacheArcLengths = cache;\r\n    return cache;\r\n  },\r\n\r\n  updateArcLengths: function() {\r\n    this.needsUpdate = true;\r\n    this.getLengths();\r\n  },\r\n\r\n  getUtoTmapping: function( u, distance ) {\r\n    let arcLengths = this.getLengths();\r\n\r\n    let i = 0;\r\n    let il = arcLengths.length;\r\n    let t;\r\n\r\n    let targetArcLength;\r\n\r\n    if ( distance ) {\r\n      targetArcLength = distance;\r\n    } else {\r\n      targetArcLength = u * arcLengths[il - 1];\r\n    }\r\n\r\n    let low = 0;\r\n    let high = il - 1;\r\n    let comparison;\r\n    while ( low <= high ) {\r\n      i = Math.floor( low + ( high - low ) / 2 );\r\n      comparison = arcLengths[i] - targetArcLength;\r\n      if ( comparison < 0 ) {\r\n        low = i + 1;\r\n      } else if ( comparison > 0 ) {\r\n        high = i - 1;\r\n      } else {\r\n        high = i;\r\n        break;\r\n      }\r\n    }\r\n\r\n    i = high;\r\n\r\n    if ( arcLengths[i] === targetArcLength ) {\r\n      t = i / ( il - 1 );\r\n      return t;\r\n    }\r\n\r\n    let lengthBefore = arcLengths[i];\r\n    let lengthAfter = arcLengths[i + 1];\r\n\r\n    let segmentLength = lengthAfter - lengthBefore;\r\n\r\n    let segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n    t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n    return t;\r\n  },\r\n\r\n  getTangent: function( t ) {\r\n    let delta = 0.0001;\r\n    let t1 = t - delta;\r\n    let t2 = t + delta;\r\n\r\n    // NOTE: svg and bezier accept out of [0, 1] value\r\n    // if ( t1 < 0 ) t1 = 0;\r\n    // if ( t2 > 1 ) t2 = 1;\r\n\r\n    let pt1 = this.getPoint( t1 );\r\n    let pt2 = this.getPoint( t2 );\r\n\r\n    let vec = pt2.clone().sub( pt1 );\r\n    return vec.normalize();\r\n  },\r\n\r\n  getTangentAt: function( u ) {\r\n    let t = this.getUtoTmapping( u );\r\n    return this.getTangent( t );\r\n  },\r\n\r\n};\r\n\r\nexport { Curve };\r\n","import {\r\n  Point,\r\n} from 'pixi.js';\r\nimport {\r\n  Curve,\r\n} from './Curve';\r\n\r\n/**\r\n * bezier curve class\r\n * @class\r\n * @param {Array}  points  array of points\r\n */\r\nfunction BezierCurve( points ) {\r\n  this.points = points;\r\n}\r\n\r\nBezierCurve.prototype = Object.create( Curve.prototype );\r\n\r\n/**\r\n * get point by progress t\r\n * @param {number} t number of in [0, 1]\r\n * @param {array} points some point\r\n * @return {Point}\r\n */\r\nBezierCurve.prototype.getPoint = function(t, points) {\r\n  const a = points || this.points;\r\n  const len = a.length;\r\n  const rT = 1 - t;\r\n  const l = a.slice(0, len - 1);\r\n  const r = a.slice(1);\r\n  const oP = new Point();\r\n  if (len > 3) {\r\n    const oL = this.getPoint(t, l);\r\n    const oR = this.getPoint(t, r);\r\n    oP.x = rT * oL.x + t * oR.x;\r\n    oP.y = rT * oL.y + t * oR.y;\r\n    return oP;\r\n  } else {\r\n    oP.x = rT * rT * a[0].x\r\n      + 2 * t * rT * a[1].x\r\n          + t * t * a[2].x;\r\n    oP.y = rT * rT * a[0].y\r\n      + 2 * t * rT * a[1].y\r\n          + t * t * a[2].y;\r\n    return oP;\r\n  }\r\n};\r\n\r\nexport { BezierCurve };\r\n","/**\r\n * https://github.com/gre/bezier-easing\r\n * BezierEasing - use bezier curve for transition easing function\r\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\r\n */\r\n\r\nconst NEWTON_ITERATIONS = 4;\r\nconst NEWTON_MIN_SLOPE = 0.001;\r\nconst SUBDIVISION_PRECISION = 0.0000001;\r\nconst SUBDIVISION_MAX_ITERATIONS = 10;\r\n\r\n\r\nlet kSplineTableSize = 11;\r\nlet kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\r\n\r\nlet float32ArraySupported = typeof Float32Array === 'function';\r\n\r\n/* eslint new-cap: 0 */\r\n\r\n/**\r\n * common factor A\r\n *\r\n * @param {number} aA1 control point 1\r\n * @param {number} aA2 control point 2\r\n * @return {number} common factor A computed result\r\n */\r\nfunction A(aA1, aA2) {\r\n  return 1.0 - 3.0 * aA2 + 3.0 * aA1;\r\n}\r\n\r\n/**\r\n * common factor B\r\n *\r\n * @param {number} aA1 control point 1\r\n * @param {number} aA2 control point 2\r\n * @return {number} common factor B computed result\r\n */\r\nfunction B(aA1, aA2) {\r\n  return 3.0 * aA2 - 6.0 * aA1;\r\n}\r\n\r\n/**\r\n * common factor C\r\n *\r\n * @param {number} aA1 control point 1\r\n * @param {number} aA2 control point 2\r\n * @return {number} common factor C computed result\r\n */\r\nfunction C(aA1) {\r\n  return 3.0 * aA1;\r\n}\r\n\r\n/**\r\n * get value when t at aT\r\n *\r\n * @param {number} aT progress t\r\n * @param {number} aA1 control point 1\r\n * @param {number} aA2 control point 2\r\n * @return {number} bezier curve computed result\r\n */\r\nfunction calcBezier(aT, aA1, aA2) {\r\n  return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT;\r\n}\r\n\r\n/**\r\n * get slope value when t at aT\r\n *\r\n * @param {number} aT progress t\r\n * @param {number} aA1 control point 1\r\n * @param {number} aA2 control point 2\r\n * @return {number} bezier curve's slope computed result\r\n */\r\nfunction getSlope(aT, aA1, aA2) {\r\n  return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1);\r\n}\r\n\r\n/**\r\n *\r\n * @param {number} aX\r\n * @param {number} aA\r\n * @param {number} aB\r\n * @param {number} mX1\r\n * @param {number} mX2\r\n * @return {number} binary-subdivide search\r\n */\r\nfunction binarySubdivide(aX, aA, aB, mX1, mX2) {\r\n  let currentX;\r\n  let currentT;\r\n  let i = 0;\r\n  do {\r\n    currentT = aA + (aB - aA) / 2.0;\r\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\r\n    if (currentX > 0.0) {\r\n      aB = currentT;\r\n    } else {\r\n      aA = currentT;\r\n    }\r\n  } while (\r\n    Math.abs(currentX) > SUBDIVISION_PRECISION\r\n    &&\r\n    ++i < SUBDIVISION_MAX_ITERATIONS\r\n  );\r\n  return currentT;\r\n}\r\n\r\n/**\r\n * Newton-Raphson iterate to estimate value faster\r\n * @param {number} aX\r\n * @param {number} aGuessT\r\n * @param {number} mX1\r\n * @param {number} mX2\r\n * @return {number} estimate value\r\n */\r\nfunction newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\r\n  for (let i = 0; i < NEWTON_ITERATIONS; ++i) {\r\n    let currentSlope = getSlope(aGuessT, mX1, mX2);\r\n    if (currentSlope === 0.0) {\r\n      return aGuessT;\r\n    }\r\n    let currentX = calcBezier(aGuessT, mX1, mX2) - aX;\r\n    aGuessT -= currentX / currentSlope;\r\n  }\r\n  return aGuessT;\r\n}\r\n\r\n/**\r\n * use cubic-bezier get bezier-easing, when start p0(0, 0) and end p3(1, 1)\r\n *\r\n * @class\r\n * @memberof JC\r\n * @param {number} mX1 control p1 component-x\r\n * @param {number} mY1 control p1 component-y\r\n * @param {number} mX2 control p2 component-x\r\n * @param {number} mY2 control p3 component-y\r\n */\r\nfunction BezierEasing(mX1, mY1, mX2, mY2) {\r\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\r\n    throw new Error('bezier x values must be in [0, 1] range');\r\n  }\r\n  this.mX1 = mX1;\r\n  this.mY1 = mY1;\r\n  this.mX2 = mX2;\r\n  this.mY2 = mY2;\r\n  this.sampleValues = float32ArraySupported ?\r\n    new Float32Array(kSplineTableSize):\r\n    new Array(kSplineTableSize);\r\n\r\n  this._preCompute();\r\n}\r\n\r\nBezierEasing.prototype._preCompute = function() {\r\n  // Precompute samples table\r\n  if (this.mX1 !== this.mY1 || this.mX2 !== this.mY2) {\r\n    for (let i = 0; i < kSplineTableSize; ++i) {\r\n      this.sampleValues[i] = calcBezier(\r\n          i * kSampleStepSize,\r\n          this.mX1,\r\n          this.mX2\r\n      );\r\n    }\r\n  }\r\n};\r\n\r\nBezierEasing.prototype._getTForX = function(aX) {\r\n  let intervalStart = 0.0;\r\n  let currentSample = 1;\r\n  let lastSample = kSplineTableSize - 1;\r\n\r\n  for (\r\n    ;\r\n    currentSample !== lastSample && this.sampleValues[currentSample] <= aX;\r\n    ++currentSample\r\n  ) {\r\n    intervalStart += kSampleStepSize;\r\n  }\r\n  --currentSample;\r\n\r\n  // Interpolate to provide an initial guess for t\r\n  let dist = (aX - this.sampleValues[currentSample]) /\r\n  (this.sampleValues[currentSample + 1] - this.sampleValues[currentSample]);\r\n  let guessForT = intervalStart + dist * kSampleStepSize;\r\n\r\n  let initialSlope = getSlope(guessForT, this.mX1, this.mX2);\r\n  if (initialSlope >= NEWTON_MIN_SLOPE) {\r\n    return newtonRaphsonIterate(aX, guessForT, this.mX1, this.mX2);\r\n  } else if (initialSlope === 0.0) {\r\n    return guessForT;\r\n  } else {\r\n    return binarySubdivide(\r\n        aX,\r\n        intervalStart,\r\n        intervalStart + kSampleStepSize,\r\n        this.mX1,\r\n        this.mX2\r\n    );\r\n  }\r\n};\r\n\r\n/**\r\n * get the y value from give x\r\n *\r\n * @param {number} x the x value\r\n * @return {number} y estimate y value\r\n */\r\nBezierEasing.prototype.get = function(x) {\r\n  if (this.mX1 === this.mY1 && this.mX2 === this.mY2) return x;\r\n  if (x === 0) {\r\n    return 0;\r\n  }\r\n  if (x === 1) {\r\n    return 1;\r\n  }\r\n  return calcBezier(this._getTForX(x), this.mY1, this.mY2);\r\n};\r\n\r\nexport { BezierEasing };\r\n\r\n","\r\nimport { BezierEasing } from './BezierEasing';\r\nconst bezierPool = {};\r\n\r\n/**\r\n * create a bezier curve by control point, and push it to cache\r\n * @param {number} mX1 control p1 component-x\r\n * @param {number} mY1 control p1 component-y\r\n * @param {number} mX2 control p2 component-x\r\n * @param {number} mY2 control p3 component-y\r\n * @param {string} nm curve name\r\n * @return {BezierEasing}\r\n */\r\nfunction prepareEaseing(mX1, mY1, mX2, mY2, nm) {\r\n  const str = nm || [mX2, mY2, mX1, mY1].join('_').replace(/\\./g, 'p');\r\n  if (bezierPool[str]) {\r\n    return bezierPool[str];\r\n  }\r\n  const bezEasing = new BezierEasing(mX1, mY1, mX2, mY2);\r\n  bezierPool[str] = bezEasing;\r\n}\r\n\r\n/**\r\n * get easeing value by curve name and progress\r\n * @param {number} s  lerp begin value\r\n * @param {number} e  lerp end value\r\n * @param {array}  nm curve name\r\n * @param {number} p  progress\r\n * @return {array}\r\n */\r\nfunction getEaseing(s, e, nm, p) {\r\n  const value = [];\r\n  for (let i = 0; i < s.length; i++) {\r\n    const rate = bezierPool[nm[i]].get(p);\r\n    const v = e[i] - s[i];\r\n    value[i] = s[i] + v * rate;\r\n  }\r\n  return value;\r\n}\r\n\r\n/**\r\n *\r\n * @param {BezierCurve} curve\r\n * @param {string} nm\r\n * @param {number} p\r\n * @return {Point}\r\n */\r\nfunction getEaseingPath(curve, nm, p) {\r\n  const rate = bezierPool[nm].get(p);\r\n  const point = curve.getPointAt(rate);\r\n  return [point.x, point.y, 0];\r\n}\r\n\r\nexport { prepareEaseing, getEaseing, getEaseingPath };\r\n","import {\r\n  Point,\r\n} from 'pixi.js';\r\nimport Utils from '../utils/Utils';\r\nimport { PROPS_MAP } from '../utils/PropsMap';\r\nimport { BezierCurve } from '../utils/BezierCurve';\r\nimport { prepareEaseing } from '../utils/Easeing';\r\n\r\n/**\r\n * keyframes buffer, cache some status and progress\r\n */\r\nexport default class KeyframesBuffer {\r\n  /**\r\n   * generate a keyframes buffer\r\n   * @param {Container} element host element\r\n   * @param {object} options layer data\r\n   * @param {number} options.tpf time of pre-frame\r\n   */\r\n  constructor(element, options) {\r\n    this.element = element;\r\n\r\n    this.layer = Utils.copyJSON(options.layer);\r\n\r\n    this.tpf = options.tpf;\r\n\r\n    this.iipt = this.layer.ip * this.tpf;\r\n    this.iopt = this.layer.op * this.tpf;\r\n\r\n    this.aks = {};\r\n    this.kic = {};\r\n\r\n    this.preParser();\r\n  }\r\n\r\n  /**\r\n   * preparser keyframes\r\n   * @private\r\n   */\r\n  preParser() {\r\n    const ks = this.layer.ks;\r\n    for (const key in ks) {\r\n      if (ks[key].a) {\r\n        this.parserDynamic(key);\r\n      } else {\r\n        this.parserStatic(key);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * preparser dynamic keyframes\r\n   * @private\r\n   * @param {string} key property\r\n   */\r\n  parserDynamic(key) {\r\n    const ksp = this.layer.ks[key];\r\n    const kspk = ksp.k;\r\n\r\n    ksp.jcst = kspk[0].t * this.tpf;\r\n    ksp.jcet = kspk[kspk.length - 1].t * this.tpf;\r\n\r\n    for (let i = 0; i < kspk.length; i++) {\r\n      const sbk = kspk[i];\r\n      const sek = kspk[i + 1];\r\n      if (sek) {\r\n        sbk.jcst = sbk.t * this.tpf;\r\n        sbk.jcet = sek.t * this.tpf;\r\n        if (Utils.isString(sbk.n) && sbk.ti && sbk.to) {\r\n          prepareEaseing(sbk.o.x, sbk.o.y, sbk.i.x, sbk.i.y);\r\n          const sp = new Point(sbk.s[0], sbk.s[1]);\r\n          const ep = new Point(sbk.e[0], sbk.e[1]);\r\n          const c1 = new Point(sbk.s[0] + sbk.ti[0], sbk.s[1] + sbk.ti[1]);\r\n          const c2 = new Point(sbk.e[0] + sbk.to[0], sbk.e[1] + sbk.to[1]);\r\n          sbk.curve = new BezierCurve([sp, c1, c2, ep]);\r\n        } else {\r\n          for (let i = 0; i < sbk.n.length; i++) {\r\n            prepareEaseing(sbk.o.x[i], sbk.o.y[i], sbk.i.x[i], sbk.i.y[i]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.aks[key] = ksp;\r\n  }\r\n\r\n  /**\r\n   * preparser static keyframes\r\n   * @private\r\n   * @param {string} key property\r\n   */\r\n  parserStatic(key) {\r\n    const ksp = this.layer.ks[key];\r\n    let kspk = ksp.k;\r\n    if (Utils.isNumber(kspk)) kspk = [kspk];\r\n\r\n    this.setValue(key, kspk);\r\n  }\r\n\r\n  /**\r\n   * set value to host element\r\n   * @private\r\n   * @param {string} key property\r\n   * @param {array} value value array\r\n   */\r\n  setValue(key, value) {\r\n    const props = PROPS_MAP[key].props;\r\n    const scale = PROPS_MAP[key].scale;\r\n    for (let i = 0; i < props.length; i++) {\r\n      const v = value[i];\r\n      this.element[props[i]] = scale * v;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Container,\r\n  Sprite,\r\n  Texture,\r\n  utils\r\n} from 'pixi.js';\r\nimport Utils from '../utils/Utils';\r\nimport KeyframesBuffer from './KeyframesBuffer';\r\nimport { getEaseing, getEaseingPath } from '../utils/Easeing';\r\n\r\n/**\r\n * detect number was in (min, max]\r\n * @param {number} v   value\r\n * @param {number} min lower\r\n * @param {number} max upper\r\n * @return {boolean} in (min, max] range ?\r\n */\r\nfunction inRange(v, min, max) {\r\n  return v > min && v <= max;\r\n}\r\n\r\n/**\r\n * detect current frame index\r\n * @param {array} steps frames array\r\n * @param {number} progress current time\r\n * @return {number} which frame index\r\n */\r\nfunction findStep(steps, progress) {\r\n  const last = steps.length - 1;\r\n  for (let i = 0; i < last; i++) {\r\n    const step = steps[i];\r\n    if (inRange(progress, step.jcst, step.jcet)) {\r\n      return i;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * an animation group, store and compute frame information\r\n */\r\nexport default class AnimationGroup {\r\n  /**\r\n   * pass a data and extra config\r\n   * @param {object} options config and data\r\n   * @param {Object} options.keyframes bodymovin data, which export from AE\r\n   * @param {Number} [options.repeats=0] need repeat somt times?\r\n   * @param {Boolean} [options.infinite=false] play this animation round and round forever\r\n   * @param {Boolean} [options.alternate=false] alternate direction every round\r\n   * @param {Number} [options.wait=0] need wait how much time to start\r\n   * @param {Number} [options.delay=0] need delay how much time to begin, effect every round\r\n   * @param {String} [options.prefix=''] assets url prefix, like link path\r\n   * @param {Number} [options.timeScale=1] animation speed\r\n   * @param {Number} [options.textures] texture arr\r\n   * @param {Function} [options.callback] callback after animation\r\n   */\r\n  constructor(options) {\r\n    this.prefix = options.prefix || '';\r\n    this.keyframes = options.keyframes;\r\n    this.fr = this.keyframes.fr;\r\n    this.ip = this.keyframes.ip;\r\n    this.op = this.keyframes.op;\r\n    this.textureArr = options.textures || '';\r\n    this.animCallback = options.callback || function() {};\r\n\r\n    this.tpf = 1000 / this.fr;\r\n    this.tfs = Math.floor(this.op - this.ip);\r\n\r\n    this.living = true;\r\n    this.alternate = options.alternate || false;\r\n    this.infinite = options.infinite || false;\r\n    this.repeats = options.repeats || 0;\r\n    this.delay = options.delay || 0;\r\n    this.wait = options.wait || 0;\r\n    this.duration = this.tfs * this.tpf;\r\n    this.progress = 0;\r\n\r\n    this.timeScale = Utils.isNumber(options.timeScale) ?\r\n      options.timeScale :\r\n      1;\r\n\r\n    this.direction = 1;\r\n    this.progress = 0;\r\n    this.repeatsCut = this.repeats;\r\n    this.delayCut = this.delay;\r\n    this.waitCut = this.wait;\r\n\r\n    this.paused = false;\r\n\r\n    this.group = new Container();\r\n\r\n    this.parserComposition(this.group, this.keyframes.layers);\r\n  }\r\n\r\n  /**\r\n   * create a sprite\r\n   * @private\r\n   * @param {object} layerData layer data\r\n   * @return {Sprite}\r\n   */\r\n  createSprite(layerData) {\r\n    const asset = this.getAssets(layerData.refId);\r\n    const up = asset.u + asset.p;\r\n    const url = asset.up || up;\r\n    let sprite;\r\n\r\n    try {\r\n      if(!this.textureArr && this.textureArr == '') {\r\n        sprite = Sprite.from(PIXI.utils.TextureCache[asset.p]);\r\n      } else {\r\n        sprite = Sprite.from(this.textureArr[asset.p]);\r\n      }\r\n    } catch(e) {\r\n      sprite = Sprite.from(Texture.EMPTY);\r\n    }\r\n\r\n    return sprite;\r\n  }\r\n\r\n  /**\r\n   * create a container\r\n   * @private\r\n   * @param {object} layerData layer data\r\n   * @return {Container}\r\n   */\r\n  createDoc(layerData) {\r\n    const doc = new Container();\r\n    return doc;\r\n  }\r\n\r\n  /**\r\n   * init all layers in this composition\r\n   * @private\r\n   * @param {array} layersData layers data\r\n   * @return {object} all display object which inited with layer data\r\n   */\r\n  initLayers(layersData) {\r\n    const layersMap = {};\r\n    const tpf = this.tpf;\r\n    for (let i = layersData.length - 1; i >= 0; i--) {\r\n      const layer = layersData[i];\r\n      let element = null;\r\n      if (layer.ty === 2) {\r\n        element = this.createSprite(layer);\r\n      } else if (layer.ty === 0) {\r\n        element = this.createDoc();\r\n      } else {\r\n        continue;\r\n      }\r\n\r\n      element.keyframesBuffer = new KeyframesBuffer(element, {\r\n        layer,\r\n        tpf,\r\n      });\r\n      element.name = layer.nm;\r\n      layersMap[layer.ind] = element;\r\n    }\r\n    return layersMap;\r\n  }\r\n\r\n  /**\r\n   * parser composition data\r\n   * @private\r\n   * @param {Container} doc root display object container\r\n   * @param {array} layersData composition data\r\n   */\r\n  parserComposition(doc, layersData) {\r\n    const layersMap = this.initLayers(layersData);\r\n    for (let i = layersData.length - 1; i >= 0; i--) {\r\n      const layer = layersData[i];\r\n      const item = layersMap[layer.ind];\r\n      if (!item) continue;\r\n      if (layer.parent) {\r\n        const parent = layersMap[layer.parent];\r\n        parent.addChild(item);\r\n      } else {\r\n        doc.addChild(item);\r\n      }\r\n      if (layer.ty === 0) {\r\n        const childLayers = this.getAssets(layer.refId).layers;\r\n        this.parserComposition(item, childLayers);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * get assets from keyframes assets\r\n   * @private\r\n   * @param {string} id assets refid\r\n   * @return {object} asset object\r\n   */\r\n  getAssets(id) {\r\n    const assets = this.keyframes.assets;\r\n    for (let i = 0; i < assets.length; i++) {\r\n      if (id === assets[i].id) return assets[i];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * update with time snippet\r\n   * @param {number} snippetCache snippet\r\n   */\r\n  update(snippetCache) {\r\n    this.updateTime(snippetCache);\r\n    this.updateTransform(this.group);\r\n  }\r\n\r\n  /**\r\n   * update timeline with time snippet\r\n   * @param {number} snippet snippet\r\n   */\r\n  updateTime(snippet) {\r\n    const snippetCache = this.direction * this.timeScale * snippet;\r\n    if (this.waitCut > 0) {\r\n      this.waitCut -= Math.abs(snippetCache);\r\n      return;\r\n    }\r\n    if (this.paused || !this.living || this.delayCut > 0) {\r\n      if (this.delayCut > 0) this.delayCut -= Math.abs(snippetCache);\r\n      return;\r\n    }\r\n\r\n    this.progress += snippetCache;\r\n\r\n    if (this.spill()) {\r\n      if (this.repeatsCut > 0 || this.infinite) {\r\n        if (this.repeatsCut > 0) --this.repeatsCut;\r\n        this.delayCut = this.delay;\r\n        if (this.alternate) {\r\n          this.direction *= -1;\r\n          this.progress = Utils.codomainBounce(this.progress, 0, this.duration);\r\n        } else {\r\n          this.direction = 1;\r\n          this.progress = Utils.euclideanModulo(this.progress, this.duration);\r\n        }\r\n      } else {\r\n        this.living = false;\r\n        this.animCallback(); // work 3 times......\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * is this time progress spill the range\r\n   * @return {boolean}\r\n   */\r\n  spill() {\r\n    const bottomSpill = this.progress <= 0 && this.direction === -1;\r\n    const topSpill = this.progress >= this.duration && this.direction === 1;\r\n    return bottomSpill || topSpill;\r\n  }\r\n\r\n  /**\r\n   * update all children transform\r\n   * @private\r\n   * @param {array} group doc\r\n   */\r\n  updateTransform(group) {\r\n    const length = group.children.length;\r\n    for (let i = 0; i < length; i++) {\r\n      const doc = group.children[i];\r\n      if (doc.children.length > 0) {\r\n        this.updateTransform(doc);\r\n      }\r\n      this.computeChildProps(doc);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * compute child transform props\r\n   * @private\r\n   * @param {Container} doc display object container\r\n   * @return {object}\r\n   */\r\n  computeChildProps(doc) {\r\n    const pose = {};\r\n    const keyframesBuffer = doc.keyframesBuffer;\r\n    for (const key in keyframesBuffer.aks) {\r\n      if (keyframesBuffer.aks[key]) {\r\n        pose[key] = this.interpolation(doc, keyframesBuffer, key);\r\n        keyframesBuffer.setValue(key, pose[key]);\r\n      }\r\n    }\r\n    return pose;\r\n  }\r\n\r\n  /**\r\n   * compute value with keyframes buffer\r\n   * @private\r\n   * @param {Container} doc display object container\r\n   * @param {Container} keyframesBuffer keyframes buffer status\r\n   * @param {string} key which prop\r\n   * @return {array}\r\n   */\r\n  interpolation(doc, keyframesBuffer, key) {\r\n    const ak = keyframesBuffer.aks[key];\r\n    const akk = ak.k;\r\n    const progress = Utils.clamp(this.progress, 0, ak.jcet);\r\n    const skt = ak.jcst;\r\n    const ekt = ak.jcet;\r\n    const invisible = progress < this.iipt;\r\n    if (invisible === doc.visible) doc.visible = !invisible;\r\n\r\n    if (progress <= skt) {\r\n      return akk[0].s;\r\n    } else if (progress >= ekt) {\r\n      const last = akk.length - 2;\r\n      return akk[last].e;\r\n    } else {\r\n      let kic = keyframesBuffer.kic[key];\r\n      if (\r\n        !Utils.isNumber(kic) ||\r\n        !inRange(progress, akk[kic].jcst, akk[kic].jcet)\r\n      ) {\r\n        kic = keyframesBuffer.kic[key] = findStep(akk, progress);\r\n      }\r\n      const frame = akk[kic];\r\n      const rate = (progress - frame.jcst) / (frame.jcet - frame.jcst);\r\n      if (frame.curve) {\r\n        return getEaseingPath(frame.curve, frame.n, rate);\r\n      } else {\r\n        return getEaseing(frame.s, frame.e, frame.n, rate);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * set animation speed, time scale\r\n   * @param {number} speed\r\n   */\r\n  setSpeed(speed) {\r\n    this.timeScale = speed;\r\n  }\r\n\r\n  /**\r\n   * pause this animation group\r\n   * @return {this}\r\n   */\r\n  pause() {\r\n    this.paused = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * pause this animation group\r\n   * @return {this}\r\n   */\r\n  resume() {\r\n    this.paused = false;\r\n    return this;\r\n  }\r\n}\r\n","import {\r\n  ticker,\r\n} from 'pixi.js';\r\nimport './patch/DisplayObject';\r\nimport './patch/Point';\r\nimport AnimationGroup from './core/AnimationGroup';\r\n\r\n/**\r\n * all animation manager, manage ticker and animation groups\r\n   * @example\r\n   * ```js\r\n   * var manager = new PIXI.AnimationManager(app.ticker);\r\n   * var ani = manager.parserAnimation({\r\n   *   keyframes: data,\r\n   *   infinite: true,\r\n   * });\r\n   * ```\r\n * @class\r\n */\r\nclass AnimationManager {\r\n  /**\r\n   * animation manager, optional a ticker param\r\n   * @param {Ticker} _ticker\r\n   */\r\n  constructor(_ticker) {\r\n    /**\r\n     * pre-time cache\r\n     *\r\n     * @member {Number}\r\n     * @private\r\n     */\r\n    this.pt = 0;\r\n\r\n    /**\r\n     * how long the time through, at this tick\r\n     *\r\n     * @member {Number}\r\n     * @private\r\n     */\r\n    this.snippet = 0;\r\n\r\n    /**\r\n     * time scale, just like speed scalar\r\n     *\r\n     * @member {Number}\r\n     */\r\n    this.timeScale = 1;\r\n\r\n    /**\r\n     * mark the manager was pause or not\r\n     *\r\n     * @member {Boolean}\r\n     */\r\n    this.paused = false;\r\n\r\n    /**\r\n     * ticker engine\r\n     * @private\r\n     */\r\n    this.ticker = _ticker || new ticker.Ticker();\r\n\r\n    /**\r\n     * all animation groups\r\n     * @private\r\n     */\r\n    this.groups = [];\r\n\r\n    this.update = this.update.bind(this);\r\n\r\n    this.start();\r\n  }\r\n\r\n  /**\r\n   * add a animationGroup child to array\r\n   * @param {AnimationGroup} child AnimationGroup instance\r\n   * @return {AnimationGroup} child\r\n   */\r\n  add(child) {\r\n    const argumentsLength = arguments.length;\r\n\r\n    if (argumentsLength > 1) {\r\n      for (let i = 0; i < argumentsLength; i++) {\r\n        /* eslint prefer-rest-params: 0 */\r\n        this.addChild(arguments[i]);\r\n      }\r\n    } else {\r\n      this.groups.push(child);\r\n    }\r\n\r\n    return child;\r\n  }\r\n\r\n  /**\r\n   * parser a bodymovin data, and post some config for this animation group\r\n   * @param {object} options bodymovin data\r\n   * @param {Object} options.keyframes bodymovin data, which export from AE\r\n   * @param {Number} [options.repeats=0] need repeat somt times?\r\n   * @param {Boolean} [options.infinite=false] play this animation round and round forever\r\n   * @param {Boolean} [options.alternate=false] alternate direction every round\r\n   * @param {Number} [options.wait=0] need wait how much time to start\r\n   * @param {Number} [options.delay=0] need delay how much time to begin, effect every round\r\n   * @param {String} [options.prefix=''] assets url prefix, like link path\r\n   * @param {Number} [options.timeScale=1] animation speed\r\n   * @return {AnimationGroup}\r\n   * @example\r\n   * ```js\r\n   * var manager = new PIXI.AnimationManager(app.ticker);\r\n   * var ani = manager.parserAnimation({\r\n   *   keyframes: data,\r\n   *   infinite: true,\r\n   * });\r\n   * ```\r\n   */\r\n  parserAnimation(options) {\r\n    const animate = new AnimationGroup(options);\r\n    return this.add(animate);\r\n  }\r\n\r\n  /**\r\n   * set animation speed, time scale\r\n   * @param {number} speed\r\n   */\r\n  setSpeed(speed) {\r\n    this.timeScale = speed;\r\n  }\r\n\r\n  /**\r\n   * start update loop\r\n   * @return {this}\r\n   */\r\n  start() {\r\n    this.pt = Date.now();\r\n    this.ticker.add(this.update);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * stop update loop\r\n   * @return {this}\r\n   */\r\n  stop() {\r\n    this.ticker.remove(this.update);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * pause all animation groups\r\n   * @return {this}\r\n   */\r\n  pause() {\r\n    this.paused = true;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * pause all animation groups\r\n   * @return {this}\r\n   */\r\n  resume() {\r\n    this.paused = false;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * update\r\n   * @private\r\n   */\r\n  update() {\r\n    this.timeline();\r\n    if (this.paused) return;\r\n    const snippetCache = this.timeScale * this.snippet;\r\n    const length = this.groups.length;\r\n    for (let i = 0; i < length; i++) {\r\n      const animationGroup = this.groups[i];\r\n      animationGroup.update(snippetCache);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get timeline snippet\r\n   *\r\n   * @private\r\n   */\r\n  timeline() {\r\n    let snippet = Date.now() - this.pt;\r\n    if (!this.pt || snippet > 200) {\r\n      this.pt = Date.now();\r\n      snippet = Date.now() - this.pt;\r\n    }\r\n    this.pt += snippet;\r\n    this.snippet = snippet;\r\n  }\r\n}\r\n\r\n\r\nexport {\r\n  AnimationGroup,\r\n  AnimationManager,\r\n};\r\n"],"names":["Object","defineProperties","DisplayObject","prototype","scaleX","get","scale","x","set","value","scaleY","y","pivotX","pivot","pivotY","Point","distanceTo","v","Math","sqrt","distanceToSquared","dx","dy","_rt","val","toString","call","Utils","copyJSON","json","JSON","parse","stringify","isArray","ks","variable","isString","isNumber","euclideanModulo","n","m","codomainBounce","min","max","clamp","a","b","PROPS_MAP","o","props","r","PI","p","s","Curve","constructor","getPoint","t","console","warn","getPointAt","u","getUtoTmapping","getPoints","divisions","isNaN","points","d","push","getSpacedPoints","getLength","lengths","getLengths","length","__arcLengthDivisions","cacheArcLengths","needsUpdate","cache","current","last","sum","updateArcLengths","distance","arcLengths","i","il","targetArcLength","low","high","comparison","floor","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","delta","t1","t2","pt1","pt2","vec","clone","sub","normalize","getTangentAt","BezierCurve","create","len","rT","l","slice","oP","oL","oR","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","abs","newtonRaphsonIterate","aGuessT","currentSlope","BezierEasing","mY1","mY2","Error","sampleValues","Array","_preCompute","_getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","bezierPool","prepareEaseing","nm","str","join","replace","bezEasing","getEaseing","e","rate","getEaseingPath","curve","point","KeyframesBuffer","element","options","layer","tpf","iipt","ip","iopt","op","aks","kic","preParser","key","parserDynamic","parserStatic","ksp","kspk","k","jcst","jcet","sbk","sek","ti","to","sp","ep","c1","c2","setValue","inRange","findStep","steps","progress","step","AnimationGroup","prefix","keyframes","fr","textureArr","textures","animCallback","callback","tfs","living","alternate","infinite","repeats","delay","wait","duration","timeScale","direction","repeatsCut","delayCut","waitCut","paused","group","Container","parserComposition","layers","layerData","asset","getAssets","refId","up","url","sprite","Sprite","from","PIXI","utils","TextureCache","Texture","EMPTY","doc","layersData","layersMap","ty","createSprite","createDoc","keyframesBuffer","name","ind","initLayers","item","parent","addChild","childLayers","id","assets","snippetCache","updateTime","updateTransform","snippet","spill","bottomSpill","topSpill","children","computeChildProps","pose","interpolation","ak","akk","skt","ekt","invisible","visible","frame","speed","AnimationManager","_ticker","pt","ticker","Ticker","groups","update","bind","start","child","argumentsLength","arguments","animate","add","Date","now","remove","timeline","animationGroup"],"mappings":"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"}